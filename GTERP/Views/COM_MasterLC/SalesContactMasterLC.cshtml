@model IEnumerable<GTERP.Models.COM_MasterLC>
<head>

    <style>

        th {
            font-size: 14px;
        }

        td {
            font-size: 13px;
        }


        div.dataTables_length {
            float: right;
        }
        /*.dt-buttons {

        }*/
        /*div.dataTables_length select {
            font-size:17px;

        }*/
        /*div.dataTables_length> label {
            display: none;
        }*/
        div.dataTables_filter {
            float: left;
            /*font-size: 17px;*/
        }

        div.dt-buttons {
            float: right;
            font-size: 12px !important;
        }
        /*div.dataTables_info {
            float: left;
        }*/

        div.dataTables_paginate {
            float: right;
        }

        div.DTTT {
            float: left;
            margin-right: 50px;
        }

        div.buttons {
            clear: both;
        }

        .fas, .far {
            font-size: 10px !important;
        }


        table.dataTable tbody td, .sorting {
            vertical-align: middle;
            text-align: center;
        }

        .sorting_asc {
            color: green;
            vertical-align: middle;
            text-align: center;
            font-style: oblique;
        }

        .sorting_desc {
            color: #0932d1;
            vertical-align: middle;
            text-align: center;
            font-style: oblique;
        }

        .table-sm th {
            padding: .8em;
            background: rgb(192,196,196);
            background: linear-gradient(0deg, rgba(192,196,196,0.6224556717218137) 1%, rgba(255,255,255,0.6224556717218137) 65%, rgba(151,149,162,0.2527077725621498) 100%);
            font-family: 'Roboto Condensed', sans-serif;
            font-weight: 500;
            font-size: 15px;
        }

        .table-hover tbody tr:hover td, .table-hover tbody tr:hover th {
            background: linear-gradient(0deg, rgba(192,196,196,0.6224556717218137) 1%, rgba(255,255,255,0.6224556717218137) 65%, rgba(151,149,162,0.2527077725621498) 100%);
        }

        #styletext {
            color: transparent;
            background: #666666;
            -webkit-background-clip: text;
            -moz-background-clip: text;
            background-clip: text;
            text-shadow: 0px 3px 3px rgba(255,255,255,0.5);
            font-weight: 100;
            font-size: 30px;
        }
    </style>
</head>



@*<p>
        @Html.ActionLink("Create New Contct / LC", "Create")
    </p>*@

<div class="container-fluid">
    <div class="card p-3">
        <div class="row mb-2">
            <div class="col-md-6 col-12">
                <h2 id="styletext">Master LC / Sales Contact Informations</h2>

            </div>
            <div class="col-md-6">
            </div>

        </div>
        <div class="table-responsive text-nowrap">
            <table id="tblmasterlclist" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th>
                            @Html.DisplayNameFor(model => model.CommercialCompanies.CompanyName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.BuyerInformations.BuyerName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.BuyerLCRef)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.OpeningBank.OpeningBankName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.TotalLCQty)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.LCValue)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Currency.CurCode)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Destinations.DestinationName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.LienBank.LienBankName)
                        </th>

                        <th>
                            @Html.DisplayNameFor(model => model.PortOfLoading.PortOfLoadingName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.UnitMasterId)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.LCRefNo)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.LCType.LCTypeName)
                        </th>

                        <th>
                            @Html.DisplayNameFor(model => model.LCOpenDate)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.LCExpirydate)
                        </th>

                        <th>
                            @Html.DisplayNameFor(model => model.LCStatus.LCStatusName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.LCNature.LCNatureName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Tenor)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.TradeTerms.TradeTermName)
                        </th>
       
                    </tr>
                <thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>
                                @Html.DisplayFor(modelItem => item.CommercialCompanies.CompanyName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.BuyerInformations.BuyerName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.BuyerLCRef)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.OpeningBank.OpeningBankName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.TotalLCQty)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.LCValue)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Currency.CurCode)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Destinations.DestinationName)

                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.LienBank.LienBankName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.PortOfLoading.PortOfLoadingName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.UnitMaster.UnitName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.LCRefNo)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.LCType.LCTypeName)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.LCOpenDate)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.LCExpirydate)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.LCStatus.LCStatusName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.LCNature.LCNatureName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Tenor)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.TradeTerms.TradeTermName)
                            </td>
                        </tr>
                    }

                </tbody>


            </table>
        </div>
        </div>
    </div>



    <script>

    $(document).ready(function () {

        $('#tblmasterlclist').DataTable({
            dom: '<"dom_wrapper fh-fixedHeader"lBf>tip',
            buttons: [
                'copy', 'csv', 'excel', 'pdf'
            ],
            "searching": true,
            "paging": true,
            "ordering": true,
            "info": true,
            "iDisplayLength": 20,
            "lengthMenu": [[5, 10, 20, 50, -1], [5, 10, 20, 50, "All"]],
            "scrollX": true,
            "scrollCollapse": true
            ////"fixedColumns": {
            ////    "leftColumns": 2,

            ////},
            //"sScrollXInner": "100%",
            //dom: 'Blfrtip',
            ////,"fixedHeader": true
        });
    });



    $('#btnUpload').click(function () {

        // Checking whether FormData is available in browser
        if (window.FormData !== undefined) {

            var fileUpload = $("#FileUpload1").get(0);
            var files = fileUpload.files;
            // Create FormData object
            var fileData = new FormData();

            //alert(fileData);
            // Looping over all files and add it to FormData object

                fileData.append(files[0].name, files[0]);

            //alert(fileData);


            $.ajax({
                url: '@Url.Action("UploadFiles", "COM_MasterLC")',
                type: "Post",
                contentType: false, // Not to set any content header
                processData: false, // Not to process data
                data: fileData
                ,
                success: function (result) {
                    if (result.Success == "1") {
                        alert('Excel Upload Successfully');
                        window.location.href = "@Url.Action("Create", "COM_MasterLC", new {Flag=1,buyerid=0})";
                        //window.location.href = "Create?BuyerID=9&Flag = 1";

                        //var buyerid = "3";
                        //var Flag = "1";
                        //window.location.href = '@Url.Action("Create", "COM_MasterLC") ?buyerid=3&Flag=1';

                        //new { id = voucherID, name = customerName }

                        @*//////window.location.href = '@Url.Action("Create", "COM_MasterLC" ,  new { buyerid = 2, Flag = "Excel"})';*@
                        //window.location.href = "Create?BuyerID=0&ExcelUpload = 1";
                    }
                    else {
                        alert(result.ex);
                    }
                }
           
            });
        } else {
            alert("FormData is not supported.");
        }
    });
    </script>
